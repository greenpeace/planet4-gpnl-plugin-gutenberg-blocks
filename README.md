# Greenpeace P4NL Gutenberg Blocks Plugin

![Planet4](./planet4.png)

# ! WorkInProgress

# Contents
- [Introduction](#introduction)
- [Composer](#composer)
- [Code Standards](#code-standards)
- [Contribute](#contribute)

## Introduction

This WordPress plugin provides the necessary blocks to be used with Gutenberg with Twig.

## Composer
We use composer as dependency manager for the this plugin.
To install dependencies run

`$ composer install`

## Code standards
We follow the [WordPress Coding Standards](https://make.wordpress.org/core/handbook/best-practices/coding-standards/php/)

We use a custom [php codesniffer](https://github.com/squizlabs/PHP_CodeSniffer) ruleset which adds some rules over WordPress-Core, WordPress-Docs and WordPress-Extra rulesets.

[WordPress Coding Standards Rulesets](https://github.com/WordPress/WordPress-Coding-Standards)

[WordPress Coding Standards Wiki](https://github.com/WordPress/WordPress-Coding-Standards/wiki)

To run the [php codesniffer](https://github.com/squizlabs/PHP_CodeSniffer)

`$ vendor/bin/phpcs` 
or 
`$ composer sniffs`

To run the [php code beautifier and fixer](https://github.com/squizlabs/PHP_CodeSniffer/wiki/Fixing-Errors-Automatically)

`$ vendor/bin/phpcbf` 
or 
`$ composer fixes`

## Contribute

Please read the [Contribution Guidelines](https://planet4.greenpeace.org/handbook/dev-contribute-to-planet4/) for Planet4.

## Commit guidelines
Included is a githook *(commit-msg)* which is run to ensure standardized commit messages. [Conventional commits](https://www.conventionalcommits.org/en/v1.0.0/#summary) is used as the convention.
### In short:
```
[optional 'maintenance' type][type]([optional scope])[breaking change]: [description]

[optional body]
```
Section | Explanation
----|----
'Maintenance' type | `Revert` `Merge`
Type | 	`build` `docs` `feat` `fix` `perf` `refactor` `style` `test` `chore`
Scope | Optional explanation of the scope of the change ie `ux` `ui` `admin` etc
Breaking change | When a breaking change is introduced use `!` after the commit type
Description | 10-52 char explanation what the commit does
Body | Optionally more axplanation on the *what* and *why*

The following commits correlate to [SemVer](https://semver.org/#summary) version changes.

Commit | SemVer change
---| ---
commit with `!` | Major version change, ie 2.x.x
commit type `feat` | Minor version change, ie x.2.x
commit with type `fix` | Patch version change, ie x.x.2

## Build process

### Development
To watch the files run `yarn start`. 
### Build for production
To build files for production run `yarn build`. 
### Linting
Linters for both CSS and JS are available both for linting and fixing.  
`yarn lint` `yarn lint:fix` for both CSS and JS  
`yarn lint:[css/js]` for either CSS or JS  
`yarn lint:[css/js]:fix` for either CSS or JS
### Release preparation
Release steps are largely automated, this includes: changing branching to loosely follow gitflow, generating assets generating changelogs and tagging the new release. Only (purposely) manual step left is pushing the branches and tags to remote.
Changelogs are autogenerated by `standard-version` if the commit guidelines are followed.  
`yarn release` for running releases
`yarn dryrelease` for checking what the impact of a release is


## Dependencies

Adding external dependencies for a block can be done by enqueueing an asset and enqueueing external assets like so:
```
		$external_assets = [
			[
				'handle' => 'swiper',
				'src'    => 'https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.1/css/swiper.css',
				'type'   => 'style'
			],
			[
				'handle' => 'swiper',
				'src'    => 'https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.1/js/swiper.js',
				'type'   => 'script'
			]
		];
		Asset_Enqueuer::enqueue_external_asset( $external_assets );

```
asd
